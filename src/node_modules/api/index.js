import R from 'ramda';
import axios from 'axios';
import phones from './mockPhones';
import categories from './mockCategories';

export const fetchPhones = async () => {
    return new Promise( (resolve, reject) => {
        let data = [];
        function transform(ph) {
            ph = ph['feed']['entry'];
            for (let key in ph) {
                let id = ph[key]['gsx$id']['$t'];
                data[id] = {};
                data[id].id = ph[key]['gsx$id']['$t'];
                data[id].category = ph[key]['gsx$category']['$t'];
                data[id].name = ph[key]['gsx$name']['$t'];
                data[id].price = ph[key]['gsx$price']['$t'];
                data[id].qty = ph[key]['gsx$qty']['$t'];
                data[id].image = ph[key]['gsx$image']['$t'];
                data[id].info = ph[key]['gsx$info']['$t'];
            }
            console.log(data);
            return data
        }
        resolve(transform(phones))
        reject('error');
    })
}

// export const fetchPhones = (phones) => {
//     let data = [];
//     console.log(data);
//     transform(phones)
//     function transform(ph) {
//         ph = ph['feed']['entry'];
//         console.log(ph);
//         for (let key in ph) {
//             let id = ph[key]['gsx$id']['$t'];
//             data[id] = {};
//             data[id].id = ph[key]['gsx$id']['$t'];
//             data[id].category = ph[key]['gsx$category']['$t'];
//             data[id].name = ph[key]['gsx$name']['$t'];
//             data[id].price = ph[key]['gsx$price']['$t'];
//             data[id].qty = ph[key]['gsx$qty']['$t'];
//             data[id].image = ph[key]['gsx$image']['$t'];
//             data[id].info = ph[key]['gsx$info']['$t'];
//             console.log(data);
//         }
//     }
//     return data
// }

// export const fetchPhones = axios.get('https://spreadsheets.google.com/feeds/list/1YFbeq6zmiDCguEQFalfXeZRMY4b3GSNy3qt382NTrMc/od6/public/basic?alt=json')
//     .then(function (response) {
//     console.log(response);
//     })
//     .catch(function (error) {
//     console.log(error);
// });

export const loadMorePhones = async ({offset}) => {
    return new Promise( (resolve, reject) => {
        resolve(phones)
        reject('error');
    })
}

export const fetchPhoneById = async id => {
    return new Promise( (resolve, reject) => {
        // here is one item from database
        const phone = R.find(R.propEq('id', id), phones)
        resolve(phone)
        reject('error');
    })
}

export const fetchCategories = async () => {
    return new Promise( (resolve, reject) => {
        resolve(categories)
        reject('error');
    })
}